---
title: '–î–∞–≤–∞–π—Ç–µ –±–ª—é—Ä–∏—Ç—å –±–µ–ª–æ—á–µ–∫ –Ω–µ–π—Ä–æ—Å–µ—Ç—è–º–∏!'
date: '2022-04-08T17:04:15.630Z'
tags: ['ML/DL']
slug: 'how-to-blur-a-suqirrel'
published: true
---

import Image from 'next/image'
import { ImperativeSquirrel } from '../components/imperativeSquirrel.tsx'
import { LayersModel } from '../components/LayersModel'

import tf from './assets/tf.png'
import SquirrelCoords from './assets/squirrelCoords.svg'
import Squirrel from './assets/squirrel.svg'
import pca from './assets/pca.png'
import modelSummary from './assets/modelSummary.png'

# –í—Å–µ —á—Ç–æ –≤–∞–º –Ω—É–∂–Ω–æ –∑–Ω–∞—Ç—å –æ —Ü–∏—Ñ—Ä–æ–≤—ã—Ö –±–µ–ª–æ—á–∫–∞—Ö

ML –∏ DL –≤–µ—Å—å–º–∞ —Ö–∞–π–ø–æ–≤–∞—è –Ω–æ –∏ –Ω–µ—Å–æ–º–Ω–µ–Ω–Ω–æ –≤–∞–∂–Ω–∞—è —Ç–µ–º–∞. –ï—Å—Ç—å –º–Ω–æ–∂–µ—Å—Ç–≤–æ –ø–æ–ª–µ–∑–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤, –≥–¥–µ –≤—ã –º–æ–∂–µ—Ç–µ –ø–æ–∑–Ω–∞–∫–æ–º–∏—Ç—å—Å—è
—Å–æ —Å–ø–æ—Å–æ–±–∞–º–∏ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –º–∞—à–∏–Ω–Ω–æ–≥–æ –∏–ª–∏ –≥–ª—É–±–æ–∫–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è (ML/DL).
–Ø –Ω–∏ –≤ –∫–æ–µ–º —Å–ª—É—á–∞–µ –Ω–µ –ø—Ä–µ—Ç–µ–Ω–¥—É—é –Ω–∞ –∑–≤–∞–Ω–∏–µ —ç–∫—Å–ø–µ—Ä—Ç–∞ –≤ —ç—Ç–æ–π –æ–±–ª–∞—Å—Ç–∏. –û—Ç–∫—Ä–æ–≤–µ–Ω–Ω–æ –≥–æ–≤–æ—Ä—è —è —Å–æ–≤—Å–µ–º –º–∞–ª–æ –∑–Ω–∞—é –ø—Ä–æ ML –∏ DL, –Ω–æ –º–Ω–µ –æ—á–µ–Ω—å —Ö–æ—á–µ—Ç—Å—è —Ä–∞–∑–æ–±—Ä–∞—Ç—å—Å—è –∫–∞–∫ –≤—Å–µ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç.
–ü–æ—ç—Ç–æ–º—É —è —Ä–µ—à–∏–ª–∞ –±–∞—Ö–Ω—É—Ç—å —Å–µ—Ä–∏—é –ø–æ—Å—Ç–æ–≤, –≥–¥–µ –≤–º–µ—Å—Ç–µ —Å —á–∏—Ç–∞—Ç–µ–ª—è–º–∏ –ø–æ–ø—Ä–æ–±—É—é —Ä–∞–∑–æ–±—Ä–∞—Ç—å—Å—è –≤ –≤–æ–ø—Ä–æ—Å–µ.

–ù–∞—á–Ω–µ–º —Å –≤—ã–º—ã—à–ª–µ–Ω–Ω–æ–π –∏—Å—Ç–æ—Ä–∏–∏ :)

## –ú–∞–ª–µ–Ω—å–∫–∏–π —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ –∫–æ—Ç–æ—Ä—ã–π –±–æ—è–ª—Å—è –º–∞—Ç–µ–º–∞—Ç–∏–∫–∏

–ñ–∏–ª-–±—ã–ª —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥-—Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫. –û–Ω –Ω–µ —Å—Ä–∞–∑—É —Å—Ç–∞–ª –∑–∞–Ω–∏–º–∞—Ç—å—Å—è —Ñ—Ä–æ–Ω—Ç–æ–º. –°–Ω–∞—á–∞–ª–∞ –æ–Ω –∑–∞–∫–æ–Ω—á–∏–ª –∫—Ä—É—Ç—ã–µ –∫—É—Ä—Å—ã, –Ω–∞—É—á–∏–ª—Å—è –≤ React –∏ Redux.
–û–Ω —É—Å—Ç—Ä–æ–∏–ª—Å—è –≤ –∫—Ä—É–ø–Ω—É—é –∫–æ–º–ø–∞–Ω–∏—é, –≤–µ—Ä—Å—Ç–∞–ª —Ç–∞–º —Ñ–æ—Ä–º–æ—á–∫–∏ –∏ –±—ã–ª —Å—á–∞—Å—Ç–ª–∏–≤.
–ù–æ –æ–¥–Ω–∞–∂–¥—ã –∫ –Ω–µ–º—É –ø—Ä–∏—à–µ–ª –≥—Ä—É—Å—Ç–Ω—ã–π —Ç–µ—Ö–ª–∏–¥ –ø—Ä–æ–µ–∫—Ç–∞.
–û–Ω —Ä–∞—Å—Å–∫–∞–∑–∞–ª –∫–∞–∫ –≤ –∏—Ö —á—É–¥–µ—Å–Ω–æ–º —Å–µ—Ä–≤–∏—Å–µ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –∫–∞—Ä—Ç–∏–Ω–æ–∫ —Å –±–µ–ª–æ—á–∫–∞–º–∏ —Å—Ç–∞–ª–∏ –ø–æ—è–≤–ª—è—Ç—å—Å—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∫–æ—Ç–∏–∫–æ–≤ –∏ —á—Ç–æ —ç—Ç–æ —Å–æ–≤–µ—Ä—à–µ–Ω–Ω–æ –Ω–µ–¥–æ–ø—É—Å—Ç–∏–º–æ.
–ù—É–∂–µ–Ω –∫–∞–∫–æ–π-—Ç–æ —Å–ø–æ—Å–æ–± –ø–æ–Ω—è—Ç—å —á—Ç–æ –Ω–∞ –∫–∞—Ä—Ç–∏–Ω–∫–µ –Ω–µ –±–µ–ª–æ—á–∫–∞, –∞ –∫–æ—Ç–∏–∫ –∏ –ø—Ä–µ–¥—É–ø—Ä–µ–¥–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –æ–± —ç—Ç–æ–π —É–∂–∞—Å–Ω–æ–π –æ—à–∏–±–∫–µ!

–§—Ä–æ–Ω—Ç–µ–Ω–¥ –ø–æ—à–µ–ª –≥—É–≥–ª–∏—Ç—å. –ö —Å–æ–∂–∞–ª–µ–Ω–∏—é, –ø–æ –∑–∞–ø—Ä–æ—Å—É "js –æ—Ç–ª–∏—á–∏—Ç—å –±–µ–ª–æ—á–∫—É –æ—Ç –∫–æ—Ç–∏–∫–∞" –Ω–∏—á–µ–≥–æ —Ç–æ–ª–∫–æ–≤–æ–≥–æ –Ω–µ –Ω–∞—à–ª–æ—Å—å.
–ù–æ –≤–æ—Ç –Ω–∞ stackoverflow –µ–º—É –ø–æ—Å–æ–≤–µ—Ç–æ–≤–∞–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Tensorflow - –∫—Ä—É—Ç–æ–π —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ –¥–ª—è —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è –±–µ–ª–æ—á–µ–∫.
–§—Ä–æ–Ω—Ç–µ–Ω–¥ –ø–æ—à–µ–ª —á–∏—Ç–∞—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é ...
–°–Ω–∞—á–∞–ª–∞ –µ–º—É –ø–æ—á–µ–º—É-—Ç–æ —Ä–µ–∫–æ–º–∞–Ω–¥–æ–≤–∞–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–∏—Ç–æ–Ω (–∞ –∫–∞–∫ –∏–∑–≤–µ—Å—Ç–Ω–æ –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥—ã –±–æ—è—Ç—Å—è –∑–º–µ–π),
–ü–æ—Ç–æ–º —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ –∑–∞–≥–ª—è–Ω—É–ª –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑–¥–µ–ª –∏ —É–≤–∏–¥–µ–ª –≤–æ—Ç —Ç–∞–∫–æ–µ:

<Image {...tf} />

–¢–µ–Ω–∑–æ—Ä—ã? –î–∞—Ç–∞ —Å–µ—Ç—ã? –°–ª–∞–π—Å—ã? –§—Ä–æ–Ω—Ç–µ–Ω–¥ –∑–∞–≥—Ä—É—Å—Ç–∏–ª –∏ —Ä–µ—à–∏–ª –¥–µ–ª–µ–≥–∏—Ä–æ–≤–∞—Ç—å –∑–∞–¥–∞—á—É –¥–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç—É –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è. –ü—Ä–∞–≤–¥–∞ –ø–æ—Ç–æ–º –æ–Ω –≤—Å–ø–æ–º–Ω–∏–ª —á—Ç–æ —Ç–∞–∫–æ–≥–æ –¥–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç–∞ –≤ –∏—Ö –∫–æ–º–ø–∞–Ω–∏–∏ –Ω–µ—Ç :)

## A —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ —á–µ–≥–æ —Ç—É—Ç –±–æ—è—Ç—å—Å—è?

–ù–∞—à –≤—ã–º—ã—à–ª–µ–Ω–Ω—ã–π —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ –∏—Å–ø—É–≥–∞–ª—Å—è –º–∞—Ç–µ–º–∞—Ç–∏–∫–∏ :) –Ø –¥–æ–≤–æ–ª—å–Ω–æ —á–∞—Å—Ç–æ –≤—Å—Ç—Ä–µ—á–∞—é –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª–æ–≤ –≤ –Ω–∞—à–µ–π –æ–±–ª–∞—Å—Ç–∏, –∫–æ—Ç–æ—Ä—ã–µ —Ç–æ–∂–µ –µ–µ –±–æ—è—Ç—Å—è.

–≠—Ç–æ—Ç —Å—Ç—Ä–∞—Ö –ø–æ—è–≤–ª—è–µ—Ç—Å—è –µ—â–µ –≤ —à–∫–æ–ª–µ –∏ —Ä–∞–∑–≤–∏–≤–∞–µ—Ç—Å—è –ø—Ä–µ–≤—Ä–∞—â–∞—è—Å—å –≤ —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å "–≤–æ—Ç –Ω–∏–∫–æ–≥–¥–∞-–Ω–∏–∫–æ–≥–¥–∞ –Ω–∏–∫–∞–∫–∏—Ö –ª–æ–≥–∞—Ä–∏—Ñ–º–æ–≤ –∏ –∏–Ω—Ç–µ–≥—Ä–∞–ª–æ–≤".
–ù–∞ —Å–∞–º–æ–º –¥–µ–ª–µ –±–æ—è—Ç—å—Å—è —Ç—É—Ç –Ω–µ—á–µ–≥–æ. –ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —É–ø—Ä–æ—â–∞—é—Ç —Ñ—Ä–æ–Ω—Ç–æ–∂–∏–∑–Ω—å.

–ë–æ–ª—å—à–∏–Ω—Ç—Å–≤–æ —á–∏—Ç–∞—Ç–µ–ª–µ–π –Ω–∞–≤–µ—Ä–Ω—è–∫–∞ –∫–æ–≥–¥–∞ - –Ω–∏–±—É–¥—å –ø–æ–ª—å–∑–æ–≤–∞–ª–∏—Å—å CSS
–ù–∞–≤–µ—Ä–Ω–æ–µ –ø—Ä–∏—Ö–æ–¥–∏–ª–æ—Å—å –ø–∏—Å–∞—Ç—å –≤–æ—Ç —Ç–∞–∫–æ–µ:

```css
.squirrel {
  transform: translateX(100px);
}
```

–ò–ª–∏ –≤–æ—Ç —Ç–∞–∫–æ–µ:

```css
.squirrel {
  transform: skewX(1);
}
```

–ê –∏–Ω–æ–≥–¥–∞ –∏ –≤–æ—Ç —Ç–∞–∫–æ–µ

```css
.squirrel {
  transform: rotate(90deg);
}
```

–ù–∞ —Å–∞–º–æ–º –¥–µ–ª–µ –¥–ª—è –≤—Å–µ—Ö —Å–ª—É—á–∞–µ–≤ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ CSS :

```css
.squirrel {
  transform: matrix3d(0, -1, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, -100, 0, 0, 1);
}
```

–¢—É—Ç –Ω–µ –Ω–∞–¥–æ –¥—É–º–∞—Ç—å, –Ω–∞–¥–æ –ø—Ä–æ—Å—Ç–æ –ø–æ–¥—Å—Ç–∞–≤–∏—Ç—å –Ω—É–∂–Ω—ã–µ —Ü–∏—Ñ–µ—Ä–∫–∏ –≤ –Ω—É–∂–Ω–æ–µ –º–µ—Å—Ç–æ.

–úatrix —ç—Ç–æ –¥–≤—É–º–µ—Ä–Ω—ã–π –º–∞—Å—Å–∏–≤:

```ts
;[
  [0, -1, 0, 0],
  [1, 0, 0, 0],
  [0, 0, 1, 0],
  [-100, 0, 0, 1],
]
```

–ò —Ä–∞–∑ —É–∂ –º—ã –∑–∞–≥–æ–≤–æ—Ä–∏–ª–∏ –æ –º–∞—Å—Å–∏–≤–∞—Ö... –ú–∞—Å—Å–∏–≤—ã –º–æ–≥—É—Ç –±—ã—Ç—å –º–Ω–æ–≥–æ–º–µ—Ä–Ω—ã–º–∏.
–í –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ ML –º—ã –Ω–∞–∑—ã–≤–∞–µ–º –º–Ω–æ–≥–æ–º–µ—Ä–Ω—ã–µ –º–∞—Å—Å–∏–≤—ã —Å —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏ –æ–¥–Ω–æ–≥–æ —Ç–∏–ø–∞ —Ç–µ–Ω–∑–æ—Ä–∞–º–∏.
–≠—Ç–æ –Ω–µ –≤–ø–æ–ª–Ω–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ, –Ω–æ –≤—Å–µ —á—Ç–æ –Ω–∞–º –Ω—É–∂–Ω–æ –∑–Ω–∞—Ç—å —ç—Ç–æ:

1. –¢–µ–Ω–∑–æ—Ä –º–æ–∂–Ω–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç—å –∫–∞–∫ –º–Ω–æ–≥–æ–º–µ—Ä–Ω—ã–π –º–∞—Å—Å–∏–≤
2. –£ —Ç–µ–Ω–∑–æ—Ä–∞ –µ—Å—Ç—å —Ä–∞–Ω–≥ –∏ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å.
   –†–∞–Ω–≥ —ç—Ç–æ —Å–∫–æ–ª—å–∫–æ –∏–Ω–¥–µ–∫—Å–æ–≤ –Ω–∞–º –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è —á—Ç–æ–±—ã –¥–æ—Å—Ç–∞—Ç—å —ç–ª–µ–º–µ–Ω—Ç –∏–∑ —Ç–µ–Ω–∑–æ—Ä–∞.
   –†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å —ç—Ç–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –ø–æ –∫–∞–∂–¥–æ–π –∏–∑ –æ—Å–µ–π.
   –ù–∞—à–∞ –º–∞—Ç—Ä–∏—Ü–∞ –∏–∑ –ø—Ä–∏–º–µ—Ä–∞ —ç—Ç–æ —Ç–µ–Ω–∑–æ—Ä —Ä–∞–Ω–≥–∞ 2 —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å—é `3 x 3`.
3. –ö–∞–∫ –ø—Ä–∞–≤–∏–ª–æ —Ç–µ–Ω–∑–æ—Ä—ã –æ–ø–∏—Å—ã–≤–∞—é—Ç –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –º–µ–∂–¥—É —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏ –Ω–∞—à–µ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞.

–ü–æ—Å–º–æ—Ç—Ä–∏–º –∫–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –±–µ–ª–æ—á–∫–∞—Ö: –î–ª—è –∫–∞–∂–¥–æ–≥–æ –±–µ–ª–∏—á—å–µ–≥–æ –ø–∏—Å–∫–µ–ª—è —Å –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º–∏ `x y` –º—ã –º–æ–∂–µ–º –ø–æ–ª—É—á–∏—Ç—å –Ω–æ–≤—ã–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã —É–º–Ω–æ–∂–∏–≤ `x y` –Ω–∞ –º–∞—Ç—Ä–∏—Ü—É –∏–∑ —Å–Ω–∏–ø–µ—Ç–∞ –≤—ã—à–µ.

<SquirrelCoords className="img" />

–û–∫–µ–π. –° —Ç–µ–Ω–∑–æ—Ä–∞–º–∏ —Ä–∞–∑–æ–±—Ä–∞–ª–∏—Å—å –∏ –º–∞—Ç–µ–º–∞—Ç–∏–∫–∏ –±–æ–ª—å—à–µ –Ω–µ –±–æ–∏–º—Å—è.

## –î–µ–∫–ª–∞—Ä–∞—Ç–∏–≤–Ω–æ –∏–ª–∏ –∏–º–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ?

–ï—Å—Ç—å –¥–≤–∞ —Å—Ç–∏–ª—è –Ω–∞–ø–∏—Å–∞–Ω–∏—è –∫–æ–¥–∞: –¥–µ–∫–ª–∞—Ä–∞—Ç–∏–≤–Ω—ã–π –∏ –∏–º–ø–µ—Ä–∞—Ç–∏–≤–Ω—ã–π

–í –ø–µ—Ä–≤–æ–º —Å–ª—É—á–∞–µ —É –Ω–∞—Å –µ—Å—Ç—å –Ω–µ–∫–∞—è –º–∞—à–∏–Ω–µ—Ä–∏—è –∫–æ—Ç–æ—Ä–∞—è –ø–æ–∑–≤–æ–ª—è–µ—Ç –Ω–∞–º —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–±–ª–µ–º—ã –Ω–∞ —á–µ–ª–æ–≤–µ—á–µ—Å–∫–æ–º —è–∑—ã–∫–µ
–∏ –æ–ø–∏—Å—ã–≤–∞—Ç—å —Ä–µ—à–µ–Ω–∏—è —ç—Ç–∏—Ö –ø—Ä–æ–±–ª–µ–º –≤ –≤–∏–¥–µ "—è —Ö–æ—á—É —á—Ç–æ–±—ã..."

–ü—Ä–∏ —ç—Ç–æ–º, –∏—Å–ø–æ–ª—å–∑—É—è –¥–µ–∫–ª–∞—Ä–∞—Ç–∏–≤–Ω—ã–π –ø–æ–¥—Ö–æ–¥ –º—ã –Ω–µ –æ—Å–æ–±–æ –∑–∞–º–æ—Ä–∞—á–∏–≤–∞–µ–º—Å—è –Ω–∞ –¥–µ—Ç–∞–ª–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏. –ú—ã –≥–æ–≤–æ—Ä–∏–º _—á—Ç–æ_ –º—ã —Ö–æ—Ç–∏–º. –ù–∞–º –Ω–µ –≤–∞–∂–Ω–æ _–∫–∞–∫_ –º—ã –ø–æ–ª—É—á–∏–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç.
–ê –≤–æ—Ç –∏—Å–ø–æ–ª—å–∑—É—è –∏–º–ø–µ—Ä–∞—Ç–∏–≤–Ω—ã–π –º—ã —Å–æ—Å—Ä–µ–¥–æ—Ç–∞—á–∏–≤–∞–µ–º—Å—è –Ω–∞ –¥–µ—Ç–∞–ª—è—Ö —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏.

–î–∞–≤–∞–π—Ç–µ —Å–¥–µ–ª–∞–µ–º —á—Ç–æ-–Ω–∏–±—É–¥—å –∏–º–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–µ –Ω–∞ —Å—Ç–∞—Ä–æ–º-–¥–æ–±—Ä–æ–º –¥–∂–∞–≤–∞—Å–∫—Ä–∏–ø—Ç–µ.
–ù–∞–ø–∏—à–µ–º —Ñ—É–Ω–∫—Ü–∏—é –∫–æ—Ç–æ—Ä–∞—è —É–º–µ–µ—Ç —Å–∫–ª–∞–¥—ã–≤–∞—Ç—å –∏ –ø–µ—Ä–µ–º–Ω–æ–∂–∞—Ç—å —Ü–∏—Ñ–µ—Ä–∫–∏.

–°–º–æ—Ç—Ä–∏—Ç–µ –∫–∞–∫ –∏–º–ø–µ—Ä–µ—Ç–∏–≤–Ω–æ:

```ts
const createValueGetter = (a, b) => x => a * x + b
const getValue = createValueGetter(2, 5)
console.log([1, 2].map(getValue)) // [7, 9]
```

## ML –∑–∞ 5 –º–∏–Ω—É—Ç:

–ú—ã –º–æ–∂–µ–º –¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å —Ä–æ–≤–Ω–æ –Ω–∞–æ–±–æ—Ä–æ—Ç: –°–æ–∑–¥–∞–µ–º –º–æ–¥–µ–ª—å. –ì–æ–≤–æ—Ä–∏–º –µ–π —á—Ç–æ —É –Ω–∞—Å –µ—Å—Ç—å (inputs) –∏ —á—Ç–æ –º—ã —Ö–æ—Ç–∏–º –ø–æ–ª—É—á–∏—Ç—å (realOutputs)
–î–∞–ª—å—à–µ –º—ã –∫–∞–∫-—Ç–æ —Ç—Ä–µ–Ω–∏—Ä—É–µ–º –Ω–∞—à—É –º–æ–¥–µ–ª—å —á—Ç–æ–±—ã –æ–Ω–∞ —É–º–µ–ª–∞ –≤—ã–¥–∞–≤–∞—Ç—å –Ω—É–∂–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç.
–°–º–æ—Ç—Ä–∏—Ç–µ –∫–∞–∫ –¥–µ–∫–ª–∞—Ä–∞—Ç–∏–≤–Ω–æ:

```ts
const inputs = [1, 2, 3, 4]
const realOutputs = [7, 9, 11, 13] // values.map(getOutput)

// ... some boring implementation of a network

const learnedParams = doTrain()
const result = layer(inputs, ...learnedParams)

console.log(result) // [6.952457161700541, 8.9797075504127, 11.00695793912486, 13.034208327837018]
```

–ù–∞ –º–æ–¥–µ–ª—å –º–æ–∂–Ω–æ —Å–º–æ—Ç—Ä–µ—Ç—å –∫–∞–∫ —á–µ—Ä–Ω—ã–π —è—â–∏–∫. –ú—ã –∑–∞–∫–∏–¥—ã–≤–∞–µ–º –≤ –Ω–µ–≥–æ –ø–∞—Ä–∞–º–µ—Ä—Ç—ã –∏ –æ–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç.
–í –ø—Ä–æ—Ü–µ—Å—Å–µ –æ–±—É—á–µ–Ω–∏—è –Ω–∞—à —á–µ—Ä–Ω—ã–π —è—â–∏–∫ –∏–∑–º–µ–Ω—è–µ—Ç —Å–≤–æ—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ç–∞–∫, —á—Ç–æ –Ω–∞ –≤—ã—Ö–æ–¥–µ –≤—Å–µ–≥–¥–∞ –±—É–¥–µ—Ç –ø–æ–ª—É—á–∞—Ç—å—Å—è —Ç–æ —á—Ç–æ –Ω–∞–º –Ω—É–∂–Ω–æ.

–ò —Ç—É—Ç —É –Ω–∞—Å —Å—Ä–∞–∑—É –∂–µ –≤–æ–∑–Ω–∏–∫–∞–µ—Ç –ø–∞—á–∫–∞ –≤–æ–ø—Ä–æ—Å–æ–≤:

## –ß—Ç–æ —Ç–∞–º –≤–Ω—É—Ç—Ä–∏ —è—â–∏–∫–∞?

–î–ª—è —ç—Ç–æ–≥–æ –¥–∞–≤–∞–π—Ç–µ –ø–æ—Å–º–æ—Ç—Ä–∏–º –Ω–∞ –ø–æ–ª–Ω—É—é —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é –ø—Ä–∏–º–µ—Ä–∞ –≤—ã—à–µ

```ts
// –∏–º–ø–µ—Ä–∞—Ç–∏–≤–Ω–µ–Ω—å–∫–æ
const createValueGetter = (a, b) => x => a * x + b
const getOutput = createValueGetter(2, 5)
console.log([1, 2].map(getOutput)) // [7, 9]

const inputs = [1, 2, 3, 4]

const realOutputs = [7, 9, 11, 13] // values.map(getOutput)
// const getValueWithML =  ??

// –≥–æ—Ç–æ–≤–∏–º –¥–µ–∫–ª–∞—Ä–∞—Ç–∏–≤–Ω–æ—Å—Ç—å :)

const trainStep = (a, b, inputs, realOutputs, step) => {
  const outputs = layer(inputs, a, b)
  const gradL = outputs.map((y, index) => y - realOutputs[index])

  const gradA = gradL.map((gr, i) => gr * outputs[i]).reduce((a, b) => a + b, 0)
  const gradB = gradL.reduce((a, b) => a + b, 0)

  return [a - gradA * step, b - gradB * step]
}

// –∑–∞–¥–∞–µ–º –Ω–∞—á–∞–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
const learningRate = 0.001
const numberOfSteps = 10000
const initialParams = [Math.random(), Math.random()]

// –∑–∞–¥–∞–µ–º –Ω–∞—à—É "–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É"
const layer = (inputs: number[], ...params: [number, number]): number[] =>
  inputs.map(x => params[0] * x + params[1])

// –∑–∞–¥–∞–µ–º –∫–∞–∫ —Å—Ä–∞–≤–Ω–∏–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
const loss = (outputs: number[], realOutputs: number[]): number =>
  outputs
    .map((y, index) => Math.pow(y - realOutputs[index], 2))
    .reduce((a, b) => a + b, 0)

// üèãÔ∏è
const doTrain = (): [number, number] =>
  [...Array(numberOfSteps)].reduce((currentParams: [number, number]) => {
    console.log(
      ...currentParams,
      loss(layer(inputs, ...currentParams), realOutputs)
    )
    return trainStep(...currentParams, inputs, realOutputs, learningRate)
  }, initialParams)

const learnedParams = doTrain()

const result = layer(inputs, ...learnedParams)
console.log(result) // [6.952457161700541, 8.9797075504127, 11.00695793912486, 13.034208327837018]
```

TLDR:

1. –ú—ã –æ–ø—Ä–µ–¥–µ–ª—è–µ–º "–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É —è—â–∏–∫–∞". –≠—Ç–æ –Ω–∞–±–æ—Ä —Ñ—É–Ω–∫—Ü–∏–π —á–µ—Ä–µ–∑ –∫–æ—Ç–æ—Ä—ã–µ –º—ã –±—É–¥–µ–º –ø—Ä–æ–≥–æ–Ω—è—Ç—å –Ω–∞—à–∏ –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ.
   –í –Ω–∞—à–µ–º –ø—Ä–∏–º–µ—Ä–µ —ç—Ç–æ

```ts
const layer = (inputs: number[], a: number, b: number): number[] =>
  inputs.map(x => a * x + b)
```

–Ø –Ω–µ –ø—Ä–æ—Å—Ç–æ —Ç–∞–∫ –Ω–∞–∑–≤–∞–ª–∞ —ç—Ç—É —Ñ—É–Ω–∫—Ü–∏—é —Å–ª–æ–µ–º (layer).

–ù–∞—à–∞ —á–û—Ä–Ω—ã–π —è—â–∏–∫ –º–æ–∂–Ω–æ —Å –Ω–∞—Ç—è–∂–∫–æ–π –Ω–∞–∑–≤–∞—Ç—å –æ–¥–Ω–æ—Å–ª–æ–π–Ω–æ–π –Ω–µ–π—Ä–æ—Å–µ—Ç—å—é :)  
–î–∞–≤–∞–π—Ç–µ –ø–æ–∫–∞ —Å—á–∏—Ç–∞—Ç—å —á—Ç–æ –Ω–µ–π—Ä–æ—Å–µ—Ç—å —ç—Ç–æ –∫–æ–º–ø–æ–∑–∏—Ü–∏—è —Ñ—É–Ω–∫—Ü–∏–π-—Å–ª–æ–µ–≤ (–∫–æ—Ç–æ—Ä–∞—è —Ç–æ–∂–µ –∫—Å—Ç–∞—Ç–∏ —è–≤–ª—è–µ—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏–µ–π)):

```ts
const networkOutput =
  // ... layer 100
  layer3(layer2(layer1(inputs)))
```

–£ –∫–∞–∂–¥–æ–≥–æ —Å–ª–æ—è –µ—Å—Ç—å —Å–≤–æ–∏ –ø–∞—Ä–∞–º–µ—Ä—Ç—ã. –ù–∞—à–∞ –∑–∞–¥–∞—á–∞ –∏—Ö –ø–æ–¥–æ–±—Ä–∞—Ç—å.

// TODO: add picture

–ó–¥–µ—Å—å –º—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ –æ—á–µ–Ω—å –ø—Ä–æ—Å—Ç—É—é —Ñ—É–Ω–∫—Ü–∏—é –¥–ª—è —Å–ª–æ—è. –†–µ–∞–ª—å–Ω—ã–µ —Å–ª–æ–∏ —Å–ª–æ–∂–Ω–µ–µ.

## –ö–∞–∫ –ø–æ–¥–æ–±—Ä–∞—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã?

–í–æ-–ø–µ—Ä–≤—ã—Ö –Ω–∞–º –Ω—É–∂–Ω–æ –≤—ã–¥–∞—Ç—å —Å–µ—Ç–æ—á–∫–µ –º–µ—Ç—Ä–∏–∫—É, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –Ω–∞—Å–∫–æ–ª—å–∫–æ —Ç–æ —á—Ç–æ –æ–Ω–∞ –≤—ã–¥–∞–µ—Ç –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è –æ—Ç —Ç–æ–≥–æ —á—Ç–æ –º—ã —Ö–æ—Ç–∏–º –ø–æ–ª—É—á–∏—Ç—å.
–≠—Ç–∞ –º–µ—Ç—Ä–∏–∫–∞ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏–µ–π –ø–æ—Ç–µ—Ä—å (loss fun—Åtion).

–í –Ω–∞—à–µ–º —Å–ª—É—á–∞–µ —ç—Ç–æ

```ts
const loss = (outputs: number[], realOutputs: number[]): number =>
  outputs
    .map((y, index) => Math.pow(y - realOutputs[index], 2))
    .reduce((a, b) => a + b, 0)
```

–ö—Å—Ç–∞—Ç–∏, —ç—Ç–æ —á—Ç–æ-—Ç–æ –ø–æ—Ö–æ–∂–µ–µ –Ω–∞ [MSE](https://en.wikipedia.org/wiki/Mean_squared_error)

–°–Ω–∞—á–∞–ª–∞ –º—ã –ø—Ä–æ–≥–æ–Ω—è–µ–º –Ω–∞—à–∏ –¥–∞–Ω–Ω—ã–µ —á–µ—Ä–µ–∑ —Å–µ—Ç—å –∏ —Å—á–∏—Ç–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Å —Ç–µ–∫—É—â–∏–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏. –ó–∞—Ç–µ–º –º—ã –≤—ã—á–∏—Å–ª—è–µ–º —Ñ—É–Ω–∫—Ü–∏—é –ø–æ—Ç–µ—Ä—å –∏ —Å—Ç–∞—Ä–∞–µ–º—Å—è –∏–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Ç–∞–∫, —á—Ç–æ–±—ã –ø–æ—Ç–µ—Ä–∏ —É–º–µ–Ω—å—à–∏–ª–∏—Å—å.
–ú—ã —É–∂–µ –∑–Ω–∞–µ–º –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ —Ä–∞–∑–¥–µ–ª–∞, —á—Ç–æ –Ω–∞—à–∞ —Å–µ—Ç—å —ç—Ç–æ –Ω–∞–±–æ—Ä —Å–ª–æ–µ–≤: –º—ã –ø–æ–¥–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏—è –Ω–∞ –≤—Ö–æ–¥, –ø–æ–ª—É—á–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏—è –Ω–∞ –≤—ã—Ö–æ–¥–µ.
–í –ø—Ä–æ—Ü–µ—Å—Å–µ –æ–±—É—á–µ–Ω–∏—è –º—ã –≤—ã—á–∏—Å–ª—è–µ–º –∫–∞–∫ —Å–∏–ª—å–Ω–æ –≤–ª–∏—è–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–µ –∫–∞–∂–¥–æ–≥–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ –Ω–∞ –≤—ã—Ö–æ–¥–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –∫–∞–∂–¥–æ–≥–æ —Å–ª–æ—è (–ø–æ–º–Ω–∏—Ç–µ –≤ —à–∫–æ–ª–µ –±—ã–ª–∏ —Ç–∞–∫–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–Ω—ã–µ. –í–æ—Ç —ç—Ç–æ –æ–Ω–∏. –ê –µ—Å–ª–∏ —Å–∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–Ω—ã–µ –ø–æ –∫–∞–∂–¥–æ–º—É –ø–∞—Ä–∞–º–µ—Ç—Ä—É –≤ –≤–µ–∫—Ç–æ—Ä, —Ç–æ –ø–æ–ª—É—á–∏—Ç—Å—è –≤–µ–∫—Ç–æ—Ä –≥—Ä–∞–¥–∏–µ–Ω—Ç)

–ú—ã —É—á–∏—Ç—ã–≤–∞–µ–º –≥—Ä–∞–¥–∏–µ–Ω—Ç—ã –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞. –í–µ–¥—å —á–µ–º –±–æ–ª—å—à–µ –≥—Ä–∞–¥–∏–µ–Ω—Ç —Ç–µ–º —Å–∏–ª—å–Ω–µ–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π –ø–∞—Ä–∞–º–µ—Ç—Ä –≤–ª–∏—è–µ—Ç –Ω–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç.

–ï—Å—Ç—å –æ–≥—Ä–æ–º–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–µ—Å—É—Ä—Å–æ–≤ –≥–¥–µ –ø—Ä–æ —ç—Ç–æ —Ä–∞—Å—Å–∫–∞–∑—ã–≤–∞—é—Ç –ø–æ–¥—Ä–æ–±–Ω–æ, –Ω–∞–ø—Ä–∏–º–µ—Ä [–≤–æ—Ç —Ç—É—Ç](https://www.youtube.com/watch?v=7sB052Pz0sQ&list=PLtBw6njQRU-rwp5__7C0oIVt26ZgjG9NI)

## –ò –¥–ª—è –∫–∞–∫–∏—Ö —Å–ª—É—á–∞–µ–≤ —ç—Ç–æ—Ç –ø–æ–¥–±–æ—Ä –±—É–¥–µ—Ç —É—Å–ø–µ—à–Ω—ã–º?

–ï—Å—Ç—å –ø—Ä–∏–∫–æ–ª—å–Ω–∞—è —Ç–µ–æ—Ä–µ–º–∞, –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è [—É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è —Ç–µ–æ—Ä–µ–º–∞ –∞–ø–ø—Ä–æ–∫—Å–∏–º–∞—Ü–∏](https://web.archive.org/web/20151010204407/http://deeplearning.cs.cmu.edu/pdfs/Cybenko.pdf)
–û–Ω–∞ —É—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–π –Ω–∞–±–æ—Ä —Å–ª–æ–µ–≤ –º—ã —Å –Ω—É–∂–Ω–æ–π —Ç–æ—á–Ω–æ—Å—Ç—å—é –º–æ–∂–µ–º –ø—Ä–∏–±–ª–∏–∂–∞—Ç—å –ª—é–±—É—é –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é.
–¢.–µ –µ—Å–ª–∏ —É –Ω–∞—Å –µ—Å—Ç—å –∫–∞–∫–∞—è-—Ç–æ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –º–µ–∂–¥—É –≤—Ö–æ–¥–Ω—ã–º–∏ –∏ –≤—ã—Ö–æ–¥–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏, –º—ã –∫–∞–∫-—Ç–æ –º–æ–∂–µ–º –ø–æ—Å—á–∏—Ç–∞—Ç—å –ø–æ—Ç–µ—Ä–∏ –∏ —Ñ—É–Ω–∫—Ü–∏—è –∫–æ—Ç–æ—Ä—É—é –º—ã –¥–ª—è —ç—Ç–æ–≥–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å–∏–º–ø–∞—Ç–∏—á–Ω–∞—è
(–ø—Ä–æ—Å—Ç–∏—Ç–µ –º–µ–Ω—è, —Ç–æ–≤–∞—Ä–∏—â–∏ –Ω–µ–±–µ–∑—Ä–∞–∑–ª–∏—á–Ω—ã–µ –∫ –º–∞—Ç–µ–º–∞—Ç–∏–∫–µ), —Ç–æ –Ω–∞—à–∞ —Å–µ—Ç–æ—á–∫–∞ –º–æ–∂–µ—Ç –Ω–∞—É—á–∏—Ç—å—Å—è –≤–µ—Å—Ç–∏ —Å–µ–±—è —Ç–∞–∫ –∂–µ –∫–∞–∫ —ç—Ç–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å.

## –≠—Ç–æ –±—ã–ª–æ –ø—Ä–æ—Å—Ç–æ. –î–∞–≤–∞–π—Ç–µ —Å–¥–µ–ª–∞–µ–º —á—Ç–æ-–Ω–∏–±—É–¥—å –ø–æ—Å–ª–æ–∂–Ω–µ–µ.

–ö–∞–∫ –∏ –≤ –ø—Ä–æ—à–ª—ã–π —Ä–∞–∑ –Ω–∞—á–Ω–µ–º —Å –∏–º–µ—Ä–∞—Ç–∏–≤–Ω–æ–≥–æ —Å–ª—É—á–∞—è :)

–ï—Å—Ç—å –∫–∞—Ä—Ç–∏–Ω–∫–∞ –±–µ–ª–æ—á–∫–∏. –ù—É–∂–Ω–æ –µ–µ –∑–∞–±–ª—é—Ä–∏—Ç—å.
–Ø –Ω–µ –±—É–¥—É –ø—Ä–∏–≤–æ–¥–∏—Ç—å –∑–¥–µ—Å—å –∫–æ–¥ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –ø–∏–∫—Å–µ–ª–µ–π –≤ `Uint8ClampedArray` –∏ —Ä–∏—Å–æ–≤–∞–Ω–∏—è –∫—Ä–∞—Å–∏–≤–æ—Å—Ç–µ–π –Ω–∞ `canvas`
–ü–æ—Å–º–æ—Ç—Ä–∏–º —Ç–æ–ª—å–∫–æ –Ω–∞ –±–ª—é—Ä—é—â—É—é –º–∞—Ç–µ–º–∞—Ç–∏–∫—É

```ts
const kernel = [
  [1 / 16, 1 / 8, 1 / 16],
  [1 / 8, 1 / 4, 1 / 8],
  [1 / 16, 1 / 8, 1 / 16],
]

const convStep = (arr1: number[], kernel): number =>
  kernel.flat().reduce((acc, v, i) => acc + v * arr1[i], 0)

const convolve = (
  array: Uint8ClampedArray,
  kernel: number[][],
  w: number,
  h: number,
  stride = 1,
  chInImage = 4
): Uint8ClampedArray => {
  const result = new Uint8ClampedArray(w * h * chInImage).fill(255)
  const kh = kernel.length
  const kw = kernel[0].length

  for (let i = 0; i < w - kw; i += stride) {
    for (let j = 0; j < h - kh; j += stride) {
      for (let c = 0; c < chInImage; c++) {
        const arrToConsolve: number[] = []
        for (let k = 0; k < kw; k++) {
          for (let l = 0; l < kh; l++) {
            arrToConsolve.push(
              array[
                chInImage * w * j +
                  chInImage * i +
                  c +
                  chInImage * k +
                  chInImage * l * kw
              ]
            )
          }
        }

        const convStepResult = convStep(arrToConsolve, kernel)
        result[chInImage * w * j + chInImage * i + c] = convStepResult
      }
    }
  }

  return result
}

const blurredSquirrel = convolve(
  imagePixels,
  kernel,
  originalSquirrel.width,
  originalSquirrel.height
)
```

–ú–∞–ª–æ —Ç–æ–≥–æ —á—Ç–æ –º—ã –∑–∞–±–ª—é—Ä–∏–ª–∏ –±–µ–ª–æ—á–∫—É –º—ã –µ—â–µ –∏ –ø–æ–±–∏–ª–∏ —Ä–µ–∫–æ—Ä–¥. 5! –≤–ª–æ–∂–µ–Ω–Ω—ã—Ö —Ü–∏–∫–ª–æ–≤ `for`

<details>
  –ö—Å—Ç–∞—Ç–∏! –ï—Å–ª–∏ –≤—ã –ø–æ–ø—Ä–æ–±—É–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é –≤—ã—à–µ –Ω–∞ –∫–∞—Ä—Ç–∏–Ω–∫–∞—Ö –±–æ–ª—å—à–æ–≥–æ
  —Ä–∞–∑–º–µ—Ä–∞ –≤–∞—à –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –±—É–¥–µ—Ç –ª–∞–≥–∞—Ç—å. –ß–∏–Ω–∏—Ç—Å—è –æ—á–µ–Ω—å –ø—Ä–æ—Å—Ç–æ ‚Äì –≤—ã–Ω–æ—Å–∏–º –Ω–∞—à—É
  –º–∞—Ç–µ—Ç–∞—Ç–∏–∫—É –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π [Web
  Worker](https://developer.mozilla.org/en-US/docs/Web/API/Web_Workers_API)
</details>

<ImperativeSquirrel />

–í—Å–µ –æ—á–µ–Ω—å –∏–º–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ, –ø—Ä–∞–≤–¥–∞ –∂–µ? –£ –Ω–∞—Å –µ—Å—Ç—å –≥–æ—Ç–æ–≤—ã–µ —á–∏—Å–ª–∞ (–∏—Ö –µ—â–µ –Ω–∞–∑—ã–≤–∞—é—Ç —è–¥—Ä–æ–º (–∏ –º—ã —Ç–µ–ø–µ—Ä—å –∑–Ω–∞–µ–º —á—Ç–æ —ç—Ç–æ —Ç–µ–Ω–∑–æ—Ä :)). –ú—ã –±–µ—Ä–µ–º —ç—Ç–∏ —á–∏—Å–ª–∞ –∏ –≤—ã–ø–æ–ª–Ω—è–µ–º –∑–∞—Ä–∞–Ω–µ–µ –∏–∑–≤–µ—Å—Ç–Ω—ã–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è.
–î–ª—è –±–ª—é—Ä–∞ –±–µ–ª–æ—á–∫–∏ –º—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ –æ–ø–µ—Ä–∞—Ü–∏—é [convolve](https://en.wikipedia.org/wiki/Convolution). –≠—Ç–∞ –æ–ø–µ—Ä–∞—Ü–∏—è –±–µ—Ä–µ—Ç –º–∞—Ç—Ä–∏—Ü—É –∑–∞–¥–∞–Ω–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞, –≤—ã–±–∏—Ä–∞–µ—Ç –∫—É—Å–æ—á–µ–∫ –∫–∞—Ä—Ç–∏–Ω–∫–∏ —Ç–∞–∫–æ–≥–æ –∂–µ —Ä–∞–∑–º–∞—Ä–µ –∏ "—Å–≤–æ—Ä–∞—á–∏–≤–∞–µ—Ç" –∏—Ö –≤–º–µ—Å—Ç–µ.

–°–≤–æ—Ä–∞—á–∏–≤–∞–µ–º —Ç–∞–∫: –ø–µ—Ä–µ–º–Ω–æ–∂–∞–µ–º –≤—Å–µ –∑–Ω–∞—á–µ–Ω–∏—è –º–∞—Ç—Ä–∏—Ü—ã –Ω–∞ –∑–Ω–∞—á–µ–Ω–∏—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö –ø–∏–∫—Å–µ–ª–µ–π. –ê –ø–æ—Ç–æ–º —Å–∫–ª–∞–¥—ã–≤–∞–µ–º –≤—Å–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã.

// TODO add convlove picture

–í—ã–±–∏—Ä–∞—è –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ —è–¥—Ä–∞ –º—ã –º–æ–∂–µ–º –ø–æ-—Ä–∞–∑–Ω–æ–º—É –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤—ã–≤–∞—Ç—å –Ω–∞—à—É –∫–∞—Ä—Ç–∏–Ω–∫—É:

- –¥–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –≥—Ä–∞–Ω–∏ —Ä–∞–∑–Ω—ã—Ö –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–π
- —Å–≥–ª–∞–∂–∏–≤–∞—Ç—å –∏–ª–∏ –¥–æ–±–∞–≤–ª—è—Ç—å —Ä–µ–∑–∫–æ—Å—Ç–∏
- –º–µ–Ω—è—Ç—å —Ü–≤–µ—Ç–∞, —è—Ä–∫–æ—Å—Ç—å –∏ –∫–æ–Ω—Ç—Ä–∞—Å—Ç

## –¶–∏—Ñ—Ä–æ–≤—ã–µ –±–µ–ª–∫–∏ –æ–ø–∞—Å–Ω—ã!

–î–∞–≤–∞–π—Ç–µ –ø–æ—Å–º–æ—Ç—Ä–∏–º –Ω–∞ –¥—Ä—É–≥—É—é –±–µ–ª–æ—á–∫—É.

<Squirrel className="img" />

–í–Ω–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–æ–≥–æ –∫–∞–∫—É—é –∑–∞–¥–∞—á—É –º—ã —Ä–µ—à–∞–µ–º, –Ω–∞–º –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è –ø—Ä–µ—Å—Ç–∞–≤–∏—Ç—å –±–µ–ª–æ—á–∫—É –≤ –≤–∏–¥–µ —Ü–∏—Ñ–µ—Ä–æ–∫.
–ü–µ—Ä–≤—ã–π –¥–µ–ª–æ–º –º—ã –ø—Ä–æ—Å—Ç–æ –ø—Ä–µ–≤—Ä–∞—Ç–∏–º –Ω–∞—à–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤ –Ω–∞–±–æ—Ä —Å—ã—Ä—ã—Ö –ø–∏–∫—Å–µ–ª–µ–π.

–ï—Å–ª–∏ —Ä–∞–∑–º—Ä–µ—Ä –±–µ–ª–æ—á–∫–∏ `M * N (2388 x 1668)` –∏ –±–µ–ª–æ—á–∫–∞ —á–µ—Ä–Ω–æ-–±–µ–ª–∞—è (–º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω –∫–∞–Ω–∞–ª), —Ç–æ –Ω–∞–º –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è –º–∞—Ç—Ä–∏—Ü–∞ —Ä–∞–∑–º–µ—Ä–æ–º `2388 x 1668 x 1`.

–†–∞–±–æ—Ç–∞—Ç—å —Å —Ç–∞–∫–∏–º–∏ –±–æ–ª—å—à–∏–º–∏ –æ–±—ä–µ–º–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö —Ç—è–∂–µ–ª–æ. –î–ª—è –ø—Ä–∏–º–µ—Ä–∞ —Å –±–ª—é—Ä–æ–º, –≤—Ä–µ–º—è –∑–∞–±–ª—é—Ä–∏–≤–∞–Ω–∏—è –ª–∏–Ω–µ–π–Ω–æ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç `M x N`
–•–æ—Ä–æ—à–∏–µ –Ω–æ–≤–æ—Å—Ç–∏ ‚Äì –Ω–∞–º –Ω–µ –Ω—É–∂–Ω—ã –≤—Å–µ –ø–∏–∫—Å–µ–ª–∏ –Ω–∞—à–µ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è.
–í–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ –º—ã –º–æ–∂–µ–º –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç—å –Ω–∞—à—É –±–µ–ª–æ—á–∫—É –∫–∞–∫-—Ç–æ –∏–Ω–∞—á–µ.

## –§–∏—á–∏

–ï—Å–ª–∏ –º—ã "—Ä–∞—Å–ø–ª—é—â–∏–º" –±–µ–ª–∏—á—å—é –º–∞—Ç—Ä–∏—Ü—É, –ø–æ–ª—É—á–∏—Ç—Å—è –±–æ–æ–æ–æ–ª—å—à–æ–π –º–∞—Å—Å–∏–≤ –¥–ª–∏–Ω–Ω–æ–π 3983184 (—ç—Ç–æ –ø—Ä–∏–º–µ—Ä–Ω–æ 3.8 Mb).
–° –¥—Ä—É–≥–æ–π —Å—Ç–æ—Ä–æ–Ω—ã, –µ—Å–ª–∏ –º—ã —Å–æ—Ö—Ä–∞–Ω–∏–º –±–µ–ª–æ—á–∫—É –≤ —Ñ—Ä–æ–º–∞—Ç–µ SVG, –º—ã –ø–æ–ª—É—á–∏–º –≤—Å–µ–≥–æ 16Kb.
–ü—Ä–∏ —ç—Ç–æ–º –º—ã –º–æ–∂–µ–º —Å–º–æ—Ç—Ä–µ—Ç—å –Ω–∞ –Ω–∞—à–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∫–∞–∫ –Ω–∞ –Ω–∞–±–æ—Ä –≥–µ–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–∏—Ö –ø—Ä–∏–º–∏—Ç–∏–≤–æ–≤. –ü—Ä–æ—Å—Ç—ã—Ö: –∫—Ä—É–∂–æ—á–∫–∏ –∏ –∫–≤–∞–¥—Ä–∞—Ç–∏–∫–∏ –∫–æ—Ç–æ—Ä—ã–µ –≤ —Å–≤–æ—é –æ—á–µ—Ä–µ–¥—å —Ñ–æ—Ä–º–∏—Ä—É—é—Ç –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω—ã–µ ‚Äì –±–µ–ª–∏—á–∏–π —Ö–≤–æ—Å—Ç.
–î–∞–ª—å—à–µ –º—ã –º–æ–∂–µ–º –∫–∞–∫-–Ω–∏–±—É–¥—å –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞—Ç—å –Ω–∞—à–∏ –≥–µ–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–º–∏—Ç–∏–≤—ã –∏ –ø–æ–ª—É—á–∏—Ç—å —Ç–µ–Ω–∑–æ—Ä —Å "—Ñ–∏—á–∞–º–∏" –∫–æ—Ç–æ—Ä—ã–µ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è —Ä–µ—à–µ–Ω–∏—è –Ω—É–∂–Ω–æ–π –Ω–∞–º –∑–∞–¥–∞—á–∏.
–ß–∞—Å—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –±–µ–ª–æ—á–∫–µ –ø—Ä–∏ —ç—Ç–æ–º –ø–æ—Ç–µ—Ä—è–µ—Ç—Å—è, –Ω–æ –ø—Ä–∏ –¥–æ–ª–∂–Ω–æ–π —Å–Ω–æ—Ä–æ–≤–∫–µ –º—ã —Å–º–æ–∂–µ–º –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –±–µ–ª–æ—á–∫—É –∏–∑ —ç—Ç–∏—Ö —Ñ–∏—á.

–î–∞–≤–∞–π—Ç–µ –ø–æ–ø—Ä–æ–±—É–µ–º —ç—Ç–æ —Å–¥–µ–ª–∞—Ç—å, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–≤ [PCA](https://en.wikipedia.org/wiki/Principal_component_analysis)

–î–ª—è –Ω–∞–±–æ—Ä–∞ –∏–∑ 800 –∫–∞—Ä—Ç–∏–Ω–æ–∫ –Ω–∞–º –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è –≤—Å–µ–≥–æ 340 —Ü–∏—Ñ—Ä —á—Ç–æ–±—ã –ø–æ–Ω—è—Ç—å —á—Ç–æ –Ω–∞ –∫–∞—Ä—Ç–∏–Ω–∫–µ –±–µ–ª–æ—á–∫–∞.
–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–≤ PCA –º—ã —É–º–µ–Ω—å—à–∞–µ–º —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –Ω–∞—à–µ–π –±–µ–ª–æ—á–∫–∏ –¥–æ 340 (—ç—Ç–æ –ø—Ä–∏–º–µ—Ä–Ω–æ 0.33 –ö–ë).

–í–æ—Ç —Ç–∞–∫ —ç—Ç–æ –≤—ã–≥–ª—è–¥–∏—Ç. –°–ª–µ–≤–∞ - –æ—Ä–∏–≥–∏–Ω–∞–ª, —Å–ø—Ä–∞–≤–∞ - –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–∞—è –∏–∑ 340 —Ñ–∏—á –±–µ–ª–∫–∞

<Image {...pca} />

## –ó–∞—á–µ–º –º—ã –∑–∞–Ω–∏–º–∞–µ–º—Å—è —ç—Ç–∏–º–∏ —Å—Ç—Ä–∞–Ω–Ω—ã–º–∏ —à—Ç—É–∫–∞–º–∏?

–í–æ-–ø–µ—Ä–≤—ã—Ö –±—ã–ª–æ –±—ã –ø—Ä–∏–∫–æ–ª—å–Ω–æ —Å–∫–∞—Ä–º–ª–∏–≤–∞—Ç—å –Ω–µ–π—Ä–æ—Å–µ—Ç–∏ "—É—Ä–µ–∑–∞–Ω–Ω—ã—Ö –±–µ–ª–æ—á–µ–∫". –†–∞—Å—Å—É–∂–¥–µ–Ω–∏—è –≤—ã—à–µ –ø–æ–∑–≤–æ–ª—è—é—Ç –ø—Ä–∏–º–µ—Ä–Ω–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç—å –Ω–∞—Å–∫–æ–ª—å–∫–æ –∏—Ö –º–æ–∂–Ω–æ —É—Ä–µ–∑–∞—Ç—å.
–í–æ-–≤—Ç–æ—Ä—ã—Ö –º—ã –º–æ–∂–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏–¥–µ–∏ –∏–∑–ª–æ–∂–µ–Ω–Ω—ã–µ –≤—ã—à–µ —á—Ç–æ–±—ã –æ–ø—Ä–µ–¥–µ–ª—è—Ç—å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É –Ω–∞—à–µ–π —Å–µ—Ç–∏. –ù–æ –ø–æ–∫–∞ –æ—Å—Ç–∞–≤–∏–º –≤ –ø–æ–∫–æ–µ —Ä–∞–∑–ª–æ–∂–µ–Ω–∏–µ –≤ –∑–∞–π–º–µ–º—Å—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–µ–π –±–µ–ª–æ–∫.

## –ù–∞—Å—Ç–∞–ª–æ –≤—Ä–µ–º—è —Ä–µ—à–∏—Ç—å —Ç—É –Ω–µ–ø–æ–¥—ä–µ–º–Ω—É—é –∑–∞–¥–∞—á—É –∏ –Ω–∞–∫–æ–Ω–µ—Ü-—Ç–æ –æ—Ç–ª–∏—á–∏—Ç—å –±–µ–ª–∫—É –æ—Ç –∫–æ—Ç–∞!

–ò—Ç–∞–∫ –Ω–∞—à –≤—ã–º—ã—à–ª–µ–Ω–Ω—ã–π —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥-—Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫ —Å–∏–¥–∏—Ç –∏ –≥—Ä—É—Å—Ç–∏—Ç. –î–∞–≤–∞–π—Ç–µ –µ–º—É –ø–æ–º–æ–∂–µ–º.

–†–∞–∑—É–º–µ–µ—Ç—Å—è –±–æ–ª–µ–µ –æ–±—â—É—é –∑–∞–¥–∞—á—É —É–∂–µ –¥–∞–≤–Ω–æ —Ä–µ—à–∏–ª–∏ –∑–∞ –Ω–µ–≥–æ. –í–æ—Ç —ç—Ç–∏–º –∏ –≤–æ—Å–ø–æ–ª—å–∑—É–µ–º—Å—è.
–ü–æ–¥—Ö–æ–¥—è—â–∏—Ö –Ω–µ–π—Ä–æ—Å–µ—Ç–æ—á–µ–∫, —É–º–µ—é—â–∏—Ö —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞—Ç—å –∑–≤–µ—Ä—É—à–µ–∫ –æ—á–µ–Ω—å –º–Ω–æ–≥–æ. –ú—ã –≤–æ–∑—å–º–µ–º —Ç—É —á—Ç–æ –ø–æ–ª–µ–≥—á–µ - [MobileNet](https://github.com/tensorflow/tfjs-models/tree/master/mobilenet)

–ü–µ—Ä–≤—ã–º –¥–µ–ª–æ–º –Ω–∞–º –Ω—É–∂–Ω–æ –∑–∞–≥—Ä—É–∑–∏—Ç—å –≥–æ—Ç–æ–≤—É—é –º–æ–¥–µ–ª—å. –í—ã–º—ã—à–ª–µ–Ω–Ω–æ –Ω–∞–≥—É–≥–ª–µ–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ —Å–æ stackoverflow –Ω–∞–º —Ç—É—Ç –∫–∞–∫ —Ä–∞–∑ –ø—Ä–∏–≥–æ–¥–∏—Ç—Å—è.
–¢–æ–ª—å–∫–æ –º—ã –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–µ –ø–∏—Ç–æ–Ω—è—á—å—é, –∞ –¥–∂–∞–≤–∞—Å–∫—Ä–∏–ø—Ç–æ–≤—É—é –≤–µ—Ä—Å–∏—é tensorflow. –ó–æ–≤–µ—Ç—Å—è –æ–Ω–∞ (–≤—ã –Ω–µ –ø–æ–≤–µ—Ä–∏—Ç–µ!) [tensorflowjs](https://www.tensorflow.org/js).
–ü–æ–∫–∞ –Ω–∞–º –Ω–µ –≤–∞–∂–Ω–æ —á—Ç–æ —ç—Ç–æ –∏ –∫–∞–∫ –æ–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç. –ì–ª–∞–≤–Ω–æ–µ —á—Ç–æ –º–æ–∂–µ—Ç –º–æ–¥–µ–ª—å–∫–∏ –≥—Ä—É–∑–∏—Ç—å :)

```ts
const loadModel = async (): Promise<tf.LayersModel> => {
  const model = await tf.loadLayersModel(MODEL_URL)
  return model
}
```

–û—Ç–ª–∏—á–Ω–æ! –ú–æ–¥–µ–ª—å–∫–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞. –û–Ω–∞ —É–º–µ–µ—Ç –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞—Ç—å –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –Ω–∞—Ö–æ–∂–¥–µ–Ω–∏—è –Ω–∞ –∫–∞—Ä–∏–Ω–∫–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤.
–≠—Ç–∞ –º–æ–¥–µ–ª—å —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∞–ª–∞—Å—å –ø–æ –æ–≥—Ä–æ–º–Ω–æ–º –¥–∞—Ç–∞-—Å–µ—Ç–µ [ImageNet](https://en.wikipedia.org/wiki/ImageNet), —Å–æ—Å—Ç–æ—è—â–µ–º –∏–∑ 1000 –∫–ª–∞—Å—Å–æ–≤ –æ–±—ä–µ–∫—Ç–æ–≤.
–í—Å–µ –∫–ª–∞—Å—Å—ã –∑–∞–±–æ—Ç–ª–∏–≤–æ —Å–ª–æ–∂–µ–Ω—ã –≤ json –∏ –≥—Ä—É–∑—è—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ (`IMAGENET_CLASSES` —ç—Ç–æ –∫–∞–∫ —Ä–∞–∑ –æ–Ω–æ)

–¢–µ–ø–µ—Ä—å –¥–∞–≤–∞–π—Ç–µ –ø–æ—Å–º–æ—Ç—Ä–∏–º —á—Ç–æ —Ç–∞–º —É –Ω–µ–µ –≤–Ω—É—Ç—Ä–∏

```ts
model.summary()
```

<Image {...modelSummary} />

–ê–≥–∞! –°–ª–æ–∏ –ø—Ä–∏—Å—É—Å—Ç–≤—É—é—Ç, –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø—Ä–∏—Å—É—Å—Ç–≤—É—é—Ç –∏ —Ç–∞–º –µ—â–µ –Ω–∞—à–∏ —Å—Ç–∞—Ä—ã–µ –¥–æ–±—Ä—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ convolve –µ—Å—Ç—å.
–ß—Ç–æ–±—ã –∑–∞–ø–∏—Ö–Ω—É—Ç—å –±–µ–ª–∫—É, –∫–æ—Ç–∞ –∏–ª–∏ –∫–æ–≥–æ —Ç–∞–º –Ω–∞–º –µ—â–µ –∑–∞—Ö–æ—á–µ—Ç—Å—è –≤ –º–æ–¥–µ–ª—å, –Ω–∞–¥–æ –Ω–∞–ø–∏—Å–∞—Ç—å —Ö–µ–ª–ø–µ—Ä –∫–æ—Ç–æ—Ä—ã–π –ø–æ—Å–ª–µ –Ω–µ–±–æ–ª—å—à–æ–≥–æ –ø—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–∏–Ω–≥–∞ –∫–∞—Ä—Ç–∏–Ω–∫–∏ –≤—ã–¥–∞—Å—Ç –Ω–∞–º –Ω—É–∂–Ω—ã–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏:

```ts
const MODEL_URL = '/models/mobilenet/model.json'
const PREPROCESS_DIVISOR = tf.scalar(255 / 2)
const WIDTH = 224
const HEIGHT = 224

const processInputImage = (input: tf.Tensor) => {
  const preprocessedInput = tf.div(
    tf.sub(input.asType('float32'), PREPROCESS_DIVISOR),
    PREPROCESS_DIVISOR
  )
  return preprocessedInput.reshape([-1, ...preprocessedInput.shape])
}

const predict = async (input: tf.Tensor, model: tf.LayersModel) =>
  model.predict(processInputImage(input))

const getProbs = async (
  img: HTMLImageElement,
  model: tf.LayersModel
): Promise<Predictions> => {
  // –ø—Ä–µ–≤—Ä–∞—â–∞–µ–º –∫–∞—Ä—Ç–∏–Ω–∫—É –≤ —Ç–µ–Ω–∑–æ—Ä
  const tensor = tf.browser.fromPixels(img)
  // –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ–º
  const result = await predict(tensor, model)
  const predictedClasses = tf.tidy(() => {
    // –ø–æ–ª—É—á–∞–µ–º —Å–∞–º—ã–µ –≤–µ—Ä–æ—è—Ç–Ω—ã–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è
    const { values, indices } = tf.topk(result as tf.Tensor)
    const valuesData = values.dataSync() as Float32Array
    const indexData = indices.dataSync()
    return valuesData.reduce(
      (acc, val, idx) => [
        ...acc,
        {
          prob: val,
          // –∏ –ø—Ä–µ–≤—Ä–∞—â–∞–µ–º —Ü–∏—Ñ–µ—Ä–∫—É —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â—É—é –∫–ª–∞—Å—Å—É –≤ –µ–≥–æ –Ω–∞–∑–≤–∞–Ω–∏–µ
          cl: IMAGENET_CLASSES[indexData[idx]][1],
        },
      ],
      []
    )
  })

  return predictedClasses
}
```

–ò –≤–æ—Ç —á—Ç–æ –ø–æ–ª—É—á–∞–µ—Ç—Å—è

<LayersModel />

<details>
  –ù–∞–≤–µ—Ä–Ω—è–∫–∞ –≤–Ω–∏–º–∞–Ω–∏–µ —á—Ç–æ –º—ã —Å–ø–ª—é—â–∏–ª–∏ –±–µ–ª–∫—É? –î–µ–ª–æ –≤ —Ç–æ–º, —á—Ç–æ —Ç–∞ —Ä–∞–∑–Ω–æ–≤–∏–¥–Ω–æ—Å—Ç—å
  MobileNet –∫–æ—Ç–æ—Ä—É—é –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º –∫—É—à–∞–µ—Ç –∫–∞—Ä—Ç–∏–Ω–∫–∏ —Ä–∞–∑–º–µ—Ä–æ–º 224 x 224. –ü–æ—ç—Ç–æ–º—É
  –Ω–∞–º –Ω—É–∂–Ω–æ –±—ã–ª–æ –æ—Ç—Ä–µ—Å–∞–π–∑–∏—Ç—å –∂–∏–≤–æ—Ç–Ω—ã—Ö. –ï—Å–ª–∏ –ø—Ä–æ–ø–æ—Ä—Ü–∏–∏ –Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç –º—ã –±—É–¥–µ–º –∏—Ö
  –∏—Å–∫–∞–∂–∞—Ç—å.
</details>

## –ê —á—Ç–æ —Ç–∞–º –∑–∞ —Å–ª–æ–∏ —Ç–∞–∫–∏–µ?

–î–∞–≤–∞–π—Ç–µ –¥–∞–ª—å—à–µ —Ä–∞–∑–±–∏—Ä–∞—Ç—å—Å—è –≤ –Ω–∞—à–µ–π –º–æ–¥–µ–ª–∏. –ö–∞–∫ –≤–æ–æ–±—â–µ –æ–Ω–∞ —É—á–∏—Ç—Å—è –∏ —á—Ç–æ –¥–µ–ª–∞–µ—Ç?
–ú—ã –º–æ–∂–µ–º –Ω–∞ —ç—Ç–æ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å :)

–î–ª—è –Ω–∞—á–∞–ª–∞ –Ω–∞–º –Ω—É–∂–Ω–æ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∫–∞–∫–∏–µ –≤–æ–æ–±—â–µ —Å–ª–æ–∏ –µ—Å—Ç—å:

```ts
model.summary()
```

–ú—ã –º–æ–∂–µ–º –≤—ã—Ç–∞—â–∏—Ç—å –∫–∞–∂–¥—ã–π —Å–ª–æ–π –∏ –ø–æ–∏–∑—É—á–∞—Ç—å –µ–≥–æ –æ—Ç–¥–µ–ª—å–Ω–æ

```ts
const LAYER_NAME = 'block_12_expand'
const layer = model.getLayer(LAYER_NAME)

// –∏–ª–∏ –≤–æ—Ç —Ç–∞–∫
const layer100 = model.layers[100]
```

–ö–∞–∫ —è —É–∂–µ —É–ø–æ–º–∏–Ω–∞–ª–∞ –≤—ã—à–µ, –∫–∞–∂–¥—ã–π —Å–ª–æ–π —ç—Ç–æ –ø—Ä–æ—Å—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è. –ú—ã –º–æ–∂–µ–º –µ–µ —Å–ø–æ–∫–æ–π–Ω–æ –ø—Ä–∏–º–µ–Ω—è—Ç—å

```ts
const layer = model.layers[0]
const result = layer.apply(processInputImage(input))
```

–í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ –º—ã –ø–æ–ª—É—á–∏–º –æ–±—ã—á–Ω—ã–π —Ç–µ–Ω–∑–æ—Ä —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å—é `1 x 112 x 112 x 32` –∏ —Ä–∞–Ω–≥–æ–º `4`.
–ù–æ –µ—Å—Ç—å –µ—â–µ –æ–¥–∏–Ω –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–π —Å–ø–æ—Å–æ–± –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–∏ [apply](https://js.tensorflow.org/api/latest/#tf.layers.Layer.apply)
–ú—ã –º–æ–∂–µ–º –≤—ã–∑–≤–∞—Ç—å —ç—Ç—É —Ñ—É–Ω–∫—Ü–∏—é –Ω–µ –Ω–∞ –Ω–∞—Å—Ç–æ—è—â–µ–º —Ç–µ–Ω–∑–æ—Ä–µ —Å –≥–æ—Ç–æ–≤—ã–º–∏ —Ü–∏—Ñ–µ—Ä–∫–∞–º–∏, –∞ –Ω–∞ "–∑–∞–≥–ª—É—à–∫–µ". –¢–∞–∫–∞—è –∑–∞–≥–ª—É—à–∫–∞ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è `SymbolicTensor`.

–í—ã–∑–≤–∞–≤ —Ñ—É–Ω–∫—Ü–∏—é apply —Å –∑–∞–≥–ª—É—à–∫–æ–π, –º—ã –º–æ–∂–µ–º —Å–æ–µ–¥–∏–Ω—è—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–ª–æ–≤–µ–≤ —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –Ω–æ–≤—É—é –º–æ–¥–µ–ª—å.
–ë–æ–ª–µ–µ —Ç–æ–≥–æ, –º—ã –º–æ–∂–µ–º —Å–æ–µ–¥–∏–Ω—è—Ç—å –æ–¥–∏–Ω —Å–ª–æ–π —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –¥—Ä—É–≥–∏–º–∏.

–ü–æ–ª—å–∑—É—è—Å—å —ç—Ç–æ–π —Ç–µ—Ö–Ω–∏–∫–æ–π –º—ã –º–æ–∂–µ–º –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –ø–æ–Ω—è—Ç—å –∫—É–¥–∞ "—Å–º–æ—Ç—Ä–∏—Ç" —Å–ª–æ–π –Ω–∞—à–µ–π –Ω–µ–π—Ä–æ—Å–µ—Ç–∏. –î–ª—è —ç—Ç–æ–≥–æ –Ω–∞–º –ø—Ä–∏–¥–µ—Ç—Å—è –Ω–µ–º–Ω–æ–∂–∫–æ –ø–æ—Ö–∏–º–∏—á–∏—Ç—å.
–Ø –Ω–µ –±—É–¥—É –ø—Ä–∏–≤–æ–¥–∏—Ç—å –∑–¥–µ—Å—å –ø–æ–ª–Ω—É—é —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é, –∫–æ—Ç–æ—Ä—É—é —è –Ω–µ —Å–º–æ–≥–ª–∞ –±—ã —Å–∫—Ä–∞—Ñ—Ç–∏—Ç—å –±–µ–∑ –ø—Ä–µ–∫—Ä–∞—Å–Ω–æ–≥–æ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è —Å –ø—Ä–∏–º–µ—Ä–∞–º–∏ –¥–ª—è [tensorflow](https://github.com/tensorflow/tfjs-examples).
–û–ø–∏—à—É –ª–∏—à—å –æ–±—â—É—é –∏–¥–µ—é –ø–æ –¥—Ä–æ–ø–Ω—É —Ä–∞–±–æ—Ç–∞—é—â–∏–π –ø—Ä–∏–º–µ—Ä—á–∏–∫. –ï—Å–ª–∏ –≤–∞–º –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏, –∏—Ö –º–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ [–≤–æ—Ç –≤ —ç—Ç–æ–º –ø–µ–π–ø–µ—Ä–µ](https://arxiv.org/abs/1312.6034).

–°–Ω–∞—á–∞–ª–∞ –Ω–∞–º –Ω—É–∂–Ω–æ –≤—ã–±—Ä–∞—Ç—å –∏–Ω—Ç–µ—Ä–µ—Å—É—é—â–∏–π –Ω–∞—Å —Å–ª–æ–π

```ts
const LAYER_NAME = 'block_12_expand'
const layer = model.getLayer(LAYER_NAME)
```

–î–∞–ª—å—à–µ —Ä–∞–∑–¥–µ–ª–∏—Ç—å –º–æ–¥–µ–ª—å–∫—É –Ω–∞ –¥–≤–µ. –ü–µ—Ä–≤–∞—è —ç—Ç–æ –≤—Å–µ —Å–ª–æ–∏ –¥–æ –Ω—É–∂–Ω–æ–≥–æ –Ω–∞–º, –≤—Ç–æ—Ä–∞—è - –≤—Å–µ —Å–ª–æ–∏ –ø–æ—Å–ª–µ –Ω—É–∂–Ω–æ–≥–æ –Ω–∞–º –∏ –¥–æ –∫–æ–Ω—Ü–∞
–í—Ç–æ—Ä—É –º–æ–¥–µ–ª—å –º—ã —Å–æ–±–∏—Ä–∞–µ–º —á–µ—Ä–µ–∑ apply.

```ts
// –Ω–∞—Ö–æ–¥–∏–º –Ω—É–∂–Ω—ã–π —Å–ª–æ–π –∏ –µ–≥–æ output
const layerOutput = layer.output
let layerIndex = model.layers.findIndex(l => l.name === LAYER_NAME)
const [_, ...outputShape] = (layerOutput as tf.SymbolicTensor).shape

// –ø–µ—Ä–≤–∞—è –º–æ–¥–µ–ª—å
const m1 = tf.model({
  inputs: model.inputs,
  outputs: layerOutput,
})

// –≤—Ç–æ—Ä–∞—è –º–æ–¥–µ–ª—å
const m2Input = tf.input({ shape: outputShape })

let nextTensor = newModelInput
const m2Layers = model.layers.slice(layerIndex + 1)
for (const l of m2Layers) {
  nextTensor = l.apply(nextTensor) as tf.SymbolicTensor
}
const m2 = tf.model({ inputs: newModelInput, outputs: nextTensor })
```

–ó–∞—Ç–µ–º –Ω—É–∂–Ω–æ –ø–æ—Å—á–∏—Ç–∞—Ç—å –∫–∞–∫ –≤–ª–∏—è–µ—Ç —Ç–æ —á—Ç–æ –º—ã –ø–æ–ª—É—á–∞–µ–º –Ω–∞ –≤—ã—Ö–æ–¥–µ –ø–µ—Ä–≤–æ–π –º–æ–¥–µ–ª–∏ –Ω–∞ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –ø–æ–ª—É—á–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∏—Ä—É—é—â–∏–π –∫–ª–∞—Å—Å (–î–ª—è –±–µ–ª–æ—á–∫–∏ —ç—Ç–æ –±—É–¥–µ—Ç –∫–ª–∞—Å—Å `335`).
–î–ª—è —ç—Ç–æ–≥–æ —Å—á–∏—Ç–∞–µ–º –≥—Ä–∞–¥–∏–µ–Ω—Ç—ã. –ò –¥–∞–ª—å—à–µ –Ω–∞ –æ—Å–Ω–æ–≤–µ —ç—Ç–∏—Ö –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–≤ —Ä–∏—Å—É–µ–º —Ç–µ–ø–ª–æ–≤—É—é –∫–∞—Ä—Ç—É.

<details>
  –í —Å–∞–º–æ–º –Ω–∞—á–∞–ª–µ —Å—Ç–∞—Ç—å–∏ —è —É–ø–æ–º–∏–Ω–∞–ª–∞ —á—Ç–æ –Ω–∞ –º–æ–¥–µ–ª—å –º–æ–∂–Ω–æ —Å–º–æ—Ç—Ä–µ—Ç—å –∫–∞–∫ –Ω–∞
  –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å–ª–æ–µ–≤. –¢–µ–ø–µ—Ä—å –≤—ã –ø–æ–Ω–∏–º–∞–µ—Ç–µ –ø–æ—á–µ–º—É —ç—Ç–æ –Ω–µ —Å–æ–≤—Å–µ–º –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ.
  –ï—Å–ª–∏ –º—ã –º–æ–∂–µ–º —Å–æ–µ–¥–∏–Ω—è—Ç—å –≤—Ö–æ–¥—ã –∏ –≤—ã—Ö–æ–¥—ã —Ä–∞–∑–Ω—ã—Ö —Å–ª–æ–µ–≤, —Ç–æ —ç—Ç–æ —É–∂–µ –Ω–µ
  –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å, –∞ –≥—Ä–∞—Ñ. –í–∞–∂–Ω–æ —á—Ç–æ–±—ã –≤ —ç—Ç–æ–º –≥—Ä–∞—Ñ–µ –Ω–µ –±—ã–ª–æ —Ü–∏–∫–ª–æ–≤.
</details>

```ts
const CLASS_INDEX = 335
// —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –∫–æ—Ç–æ—Ä–æ–π –±—É–¥–µ–º —Å—á–∏—Ç–∞—Ç—å –≥—Ä–∞–¥–∏–µ–Ω—Ç—ã. –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –ø–æ–ª—É—á–∏—Ç—å –∏–Ω—Ç–µ—Ä–µ—Å—É—é—â–∏–π –Ω–∞—Å –∫–ª–∞—Å—Å –¥–ª—è –≤—Ç–æ—Ä–æ–π –º–æ–¥–µ–ª–∏.
const classProbability = (input: tf.Tensor) =>
  (m2.apply(input, { training: true }) as tf.Tensor).gather([CLASS_INDEX], 1)

// —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ –≥—Ä–∞–¥–∏–µ–Ω—Ç
const gradFn = tf.grad(classProbability)

// –ø—Ä–æ–≥–æ–Ω—è–µ–º –ø–µ—Ä–≤—É—é –º–æ–¥–µ–ª—å
const m1Output = m1.apply(input)

// —Å—á–∏—Ç–∞–µ–º –∫–∞–∫ output –∏–Ω—Ç–µ—Ä–µ—Å—É—é—â–µ–≥–æ –Ω–∞—Å —Å–ª–æ—è –≤–ª–∏—è–µ—Ç –Ω–∞ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –ø–æ–ª—É—á–∏—Ç—å –Ω—É–∂–Ω—ã–π –∫–ª–∞—Å—Å
const gradValues = tf.mean(gradFn(m1Output as tf.Tensor), [0, 1, 2])

// –ø—Ä–∏–º–µ–Ω—è–µ–º –≥—Ä–∞–¥–∏–µ–Ω—Ç—ã –∫ –≤—Ç–æ—Ä–æ–π –º–æ–¥–µ–ª–∏
const m2ScaledOutput = (m1Output as tf.Tensor).mul(gradValues)

// –Ω–∞ –æ—Å–Ω–æ–≤–µ –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–≤ —Å—Ç—Ä–æ–∏–º —Ç–µ–ø–ª–æ–≤—É—é –∫–∞—Ä—Ç—É
heatMap = getHeatMap(scaledConvOutputValues)

// —Ä–µ—Å–∞–π–∑–∏–º heat map
tf.image.resizeBilinear(heatMap as tf.Tensor<tf.Rank.R3>, [width, height])
```

<LayersModel showHeatMap />

–ö–∞—Ä—Ç–∞ –ø–æ–¥—Å–≤–µ—á–∏–≤–∞–µ—Ç —Ç–µ —á–∞—Å—Ç–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è, –±–ª–∞–≥–æ–¥–∞—Ä—è –∫–æ—Ç–æ—Ä—ã–º –Ω–∞—à —Å–ª–æ–π –≤—ã–¥–∞–ª —Ç–∞–∫–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è —á—Ç–æ –ø–æ–ª—É—á–∏–ª—Å—è –Ω—É–∂–Ω—ã–π –∫–ª–∞—Å—Å.

<details>
  –¢–µ—Ö–Ω–∏–∫–∞ –≤—ã—à–µ –¥–∞–ª–µ–∫–æ –Ω–µ —Å–∞–º–∞—è –ø—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è. –í–æ—Ç [–µ—â–µ –æ–¥–∏–Ω
  paper](https://arxiv.org/abs/1703.01365) –∫–æ—Ç–æ—Ä—ã–π –æ–ø–∏—Å—ã–≤–∞–µ—Ç –¥—Ä—É–≥–æ–π —Å–ø–æ—Å–æ–±
  –ø–æ—Å—á–∏—Ç–∞—Ç—å –∫–∞–∫–∏–µ —á–∞—Å—Ç–∏ –≤—Ö–æ–¥–Ω–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤–ª–∏—è—é—Ç –Ω–∞ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω—ã–π –∫–ª–∞—Å—Å
</details>

## –§—É—É—É—Ö! –Ø –Ω–µ–º–Ω–æ–≥–æ —É—Ç–æ–º–∏–ª–∞—Å—å, –Ω–æ –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –ø–æ—Å–ª–µ–¥—É–µ—Ç

–ö–∞–∂–µ—Ç—Å—è –Ω–∞—à –≤—ã–º—ã—à–ª–µ–Ω–Ω—ã–π —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ –¥–æ–≤–æ–ª–µ–Ω –∏ –µ–≥–æ –Ω–µ —É–≤–æ–ª—è—Ç —Å —Ä–∞–±–æ—Ç—ã.
–ë–æ–ª–µ–µ —Ç–æ–≥–æ, –º—ã –ø—Ä–∏–º–µ—Ä–Ω–æ —Ä–∞–∑–æ–±—Ä–∞–ª–∏—Å—å –∫–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–ª–∞—Å—Å —Ä–∞—Å–ø–æ–∑–Ω–∞—é—â–∏—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–µ–π—Ä–æ—Å–µ—Ç–µ–π.
–ù–æ –º—ã –≤—Å–µ –µ—â–µ –æ—á–µ–Ω—å –¥–∞–ª–µ–∫–∏ –æ—Ç –ø–æ–Ω–∏–º–∞–Ω–∏—è —Ç–æ–≥–æ –∫–∞–∫ –ø—Ä–∏–º–µ–Ω—è—Ç—å —ç—Ç–∏ –∑–Ω–∞–Ω–∏—è –∏ —Ç–µ—Ö–Ω–∏–∫–∏ –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ. –¢–∞–∫ —á—Ç–æ –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ —Å–ª–µ–¥—É–µ—Ç!
